---
title: "Biostat 212A Homework 3"
subtitle: "Due Feb 18, 2025 @ 11:59PM"
author: "Jiaye Tian and UID: 306541095"
date: today
format:
  html:
    theme: cosmo
    embed-resources: true
    number-sections: true
    toc: true
    toc-depth: 4
    toc-location: left
    code-fold: false
engine: knitr
knitr:
  opts_chunk: 
    fig.align: 'center'
    # fig.width: 6
    # fig.height: 4
    message: FALSE
    cache: false
---

## ISL Exercise 5.4.2 (10pts)
We will now derive the probability that a given observation is part of 
a bootstrap sample. 
Suppose that we obtain a bootstrap sample from a set of n observations.

(a) $1 - 1/n$
The probability that the ùëóth observation is not the first bootstrap 
observation is 1 - 1/n.
Since there are n observations, each has an equal probability of 1/n of 
being chosen first. Therefore, the probability that the jth observation 
is not selected as the first bootstrap observation is 1 ‚àí 1/n.
(b)$1 - 1/n$
Since each bootstrap observation is independently drawn with replacement, 
every selection follows the same probability distribution.
(c)

(d)

(e)

(f)

(g)

(h)


## ISL Exercise 5.4.9 (20pts)
```{r}
library(MASS)
library(boot)
attach(Boston)
```
## The following objects are masked _by_ .GlobalEnv:
## 
##     chas, crim01
```{r}
mu.hat <- mean(medv)
mu.hat
```
(b)
```{r}
se.hat <- sd(medv) / sqrt(dim(Boston)[1])
se.hat
```
(c)
```{r}
set.seed(1)
boot.fn <- function(data, index) {
    mu <- mean(data[index])
    return (mu)
}
boot(medv, boot.fn, 1000)
```
(d)
```{r}
t.test(medv)
```
## Least squares is MLE (10pts)

Show that in the case of linear model with Gaussian errors, maximum likelihood and least squares are the same thing, and $C_p$ and AIC are equivalent.

## ISL Exercise 6.6.1 (10pts)

## ISL Exercise 6.6.3 (10pts)

## ISL Exercise 6.6.4 (10pts)

## ISL Exercise 6.6.5 (10pts)

## ISL Exercise 6.6.11 (30pts)

You must follow the [typical machine learning paradigm](https://ucla-biostat-212a.github.io/2024winter/slides/06-modelselection/workflow_lasso.html) to compare _at least_ 3 methods: least squares, lasso, and ridge. Report final results as

| Method | CV RMSE | Test RMSE |
|:------:|:------:|:------:|:------:|
| LS | | | |
| Ridge | | | |
| Lasso | | | |
| ... | | | |

## Bonus question (20pts)

Consider a linear regression, fit by least squares to a set of training data $(x_1, y_1), \ldots, (x_N,  y_N)$ drawn at random from a population. Let $\hat \beta$ be the least squares estimate. Suppose we have some test data $(\tilde{x}_1, \tilde{y}_1), \ldots, (\tilde{x}_M, \tilde{y}_M)$ drawn at random from the same population as the training data. If $R_{\text{train}}(\beta) = \frac{1}{N} \sum_{i=1}^N (y_i - \beta^T x_i)^2$ and $R_{\text{test}}(\beta) = \frac{1}{M} \sum_{i=1}^M (\tilde{y}_i - \beta^T \tilde{x}_i)^2$. Show that
$$
\operatorname{E}[R_{\text{train}}(\hat{\beta})] < \operatorname{E}[R_{\text{test}}(\hat{\beta})].
$$